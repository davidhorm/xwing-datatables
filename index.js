var tabDefinitions=[{divId:"#pilotDiv",tableObj:null},{divId:"#upgradeDiv",tableObj:null},{divId:"#damageDeckDiv",tableObj:null},{divId:"#aboutDiv",tableObj:null}];function loadPage(){hideAllTables();$(tabDefinitions[0].divId).show();setClickHandlers();loadDataTables()}function hideAllTables(){tabDefinitions.forEach(function(tabDef,index){$(tabDef.divId).hide();setFixedHeaderVisibility(tabDefinitions[index].tableObj,false)})}function setFixedHeaderVisibility(tableObj,isVisibile){if(tableObj!==null){var tableContainer=$(tableObj.table().container());tableContainer.css("display",isVisibile?"block":"none");tableObj.fixedHeader.adjust()}}function setClickHandlers(){var tabBar=new mdc.tabBar.MDCTabBar(document.querySelector(".mdc-tab-bar"));tabBar.preventDefaultOnClick=true;tabBar.listen("MDCTabBar:activated",function(t){var tabIndex=t.detail.index;hideAllTables();$(tabDefinitions[tabIndex].divId).show();setFixedHeaderVisibility(tabDefinitions[tabIndex].tableObj,true)})}function loadDataTables(){populatePilotTable();populateUpgradeTable();populateDamageDeckTable()}function populateTable(tableId,dataPath,columnsConfig){appendFooter(tableId,columnsConfig);var table=$(tableId).DataTable({ajax:dataPath,columns:columnsConfig,autoWidth:false,paging:false,processing:true,fixedHeader:true,colReorder:true,dom:"Bfrtip",buttons:getButtonsConfig(),initComplete:function(){createDropdownFilter(this)}});return table}function getButtonsConfig(){var buttonsConfig={dom:{button:{tag:"button",className:"mdc-button mdc-button--dense",active:"mdc-button--unelevated"}},buttons:[{extend:"colvis",className:"mdc-button"},{extend:"excel",className:"mdc-button",title:null,exportOptions:{format:{header:function(data,columnId){var removeAt=data.indexOf("<div");return removeAt>0?data.substr(0,removeAt):data}}}}]};return buttonsConfig}function appendFooter(tableId,columnsConfig){var emptyTd="<td></td>";var footerCells="";for(var i=0;i<columnsConfig.length;i++){footerCells+=emptyTd}$(tableId+" > tfoot").append("<tr>"+footerCells+"</tr>")}function createDropdownFilter(dataTable){dataTable.api().columns().every(function(){var column=this;var dropdown=$('<div class="dropdown"></div>').appendTo($(column.footer()));getSearchBox(column).appendTo(dropdown)})}function getSearchBox(column){var headerText=$(column.header()).text();var searchbox=$('<div class="searchbox"></div>');var input=$('<input type="text" placeholder="Search '+headerText+'" />').appendTo(searchbox).on("keyup change",function(){if(column.search()!==this.value){column.search(this.value).draw()}});return searchbox}function populatePilotTable(){var pilotColumnsConfig=[{title:"Faction",data:"faction"},{title:"Ship Name",data:"ship_name"},{title:"Initiative",data:"initiative",className:"dt-body-center"},{title:"Pilot",data:"pilot_name_formatted",visible:false},{title:"Pilot Name",data:"pilot_name"},{title:"Caption",data:"caption",defaultContent:""},{title:"Limited",data:"limited",className:"dt-body-center"},{title:"Cost",data:"cost",className:"dt-body-center"},{title:"Pilot Ability",data:"ability",defaultContent:""},{title:"Ship Ability",data:"shipAbility",defaultContent:""},{title:"Actions",data:"actions",render:"[, ]"},{title:"Slots",data:"slots",render:"[, ]"},{title:"Size",data:"size"},{title:"Dial",data:"dial",render:"[, ]",visible:false},{title:"Attack Arc",data:"attack_arc"},{title:"Attack Value",className:"dt-body-center",data:"attack_value"},{title:"Agility",className:"dt-body-center",data:"agility"},{title:"Hull",className:"dt-body-center",data:"hull"},{title:"Shields",className:"dt-body-center",defaultContent:"",data:"shields"},{title:"Force",className:"dt-body-center",defaultContent:"",data:"force.value"},{title:"Charges",className:"dt-body-center",defaultContent:"",data:"charges.value"},{title:"Image Link",defaultContent:"",data:"image_link",orderable:false},{title:"Image Url",defaultContent:"",data:"image",visible:false}];var tableObj=populateTable("#pilotTable","data/pilots.json",pilotColumnsConfig);tabDefinitions[0].tableObj=tableObj;tableObj.column("0:visible").order("asc").draw()}function populateUpgradeTable(){var upgradeColumnsConfig=[{title:"Name",data:"title"},{title:"Limited",data:"limited",className:"dt-body-center"},{title:"Slots",data:"slots",render:"[, ]"},{title:"Cost",data:"cost",className:"dt-body-center",defaultContent:""},{title:"Variable Cost",data:"variable_cost",defaultContent:""},{title:"Ability",data:"ability",defaultContent:""},{title:"Restrictions",data:"restrictions",defaultContent:""},{title:"Force",className:"dt-body-center",defaultContent:"",data:"force.value"},{title:"Charges",className:"dt-body-center",defaultContent:"",data:"charges.value"},{title:"Attack Arc",data:"attack_arc",defaultContent:""},{title:"Attack Value",data:"attack_value",className:"dt-body-center",defaultContent:""},{title:"Attack Range",data:"attack_range",className:"dt-body-center",defaultContent:""},{title:"Range Bonus",data:"attack_ordnance",className:"dt-body-center",defaultContent:""},{title:"Add Actions",data:"actions",defaultContent:""},{title:"Add Stats",data:"add_stats",defaultContent:""},{title:"Add Slots",data:"add_slots",defaultContent:""},{title:"Remove Slots",data:"remove_slots",defaultContent:""},{title:"Image Link",data:"image_link",orderable:false},{title:"Image Url",data:"image",visible:false}];var tableObj=populateTable("#upgradeTable","data/upgrades.json",upgradeColumnsConfig);tabDefinitions[1].tableObj=tableObj}function populateDamageDeckTable(){var damageDeckColumnsConfig=[{title:"Title",data:"title"},{title:"Amount",data:"amount",className:"dt-body-center"},{title:"Type",data:"type"},{title:"Text",data:"text"}];var tableObj=populateTable("#damageDeckTable","data/damage-deck.json",damageDeckColumnsConfig);tabDefinitions[2].tableObj=tableObj}